{% extends "base.html" %}
{% block content %}
<div class="auth-wrapper">
    <div class="register-container">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="CakeHistory Logo" class="auth-logo">

        <h2>Create Your Account</h2>
        <form method="POST" action="{{ url_for('register') }}" onsubmit="return validateForm()">
            <input type="text" id="name" name="name" placeholder="Full Name" required>
            <p id="name-error" style="color: red; font-size: 14px; display: none;">Name cannot contain numbers or special characters.</p>

            <input type="email" name="email" placeholder="Email Address" required>

            <input type="password" id="password" name="password" placeholder="Password" required>
            <input type="password" id="confirm_password" name="confirm_password" placeholder="Confirm Password" required>
            <p id="password-error" style="color: red; font-size: 14px; display: none;">Passwords do not match.</p>

            <div class="subscribe-box">
                <input type="checkbox" id="subscribed" name="subscribed" value="yes">
                <label for="subscribed">I would like to receive CakeHistory's latest offers and seasonal updates.</label>
            </div>

            <button type="submit">Register</button>
        </form>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <p class="flash-message {{ category }}">{{ message }}</p>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <p class="login-link">
            Already have an account?
            <a href="{{ url_for('login_user_route') }}">Login here</a>
        </p>
    </div>
</div>

<!-- Validation script -->
<script>
function validateForm() {
    const name = document.getElementById("name").value.trim();
    const password = document.getElementById("password").value.trim();
    const confirmPassword = document.getElementById("confirm_password").value.trim();

    const nameError = document.getElementById("name-error");
    const passwordError = document.getElementById("password-error");

    // Name validation: letters, spaces, and hyphens only
    const namePattern = /^[A-Za-z\s]+$/;

    if (!namePattern.test(name)) {
        nameError.style.display = "block";
        return false;
    } else {
        nameError.style.display = "none";
    }

    // Password match check
    if (password !== confirmPassword) {
        passwordError.style.display = "block";
        return false;
    } else {
        passwordError.style.display = "none";
    }

    return true;
}
</script>
{% endblock %}
